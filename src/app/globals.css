@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 220 13% 96%;
    --foreground: 220 13% 13%;
    --card: 0 0% 100%;
    --card-foreground: 220 13% 13%;
    --popover: 0 0% 100%;
    --popover-foreground: 220 13% 13%;
    --primary: 231 48% 48%;
    --primary-foreground: 0 0% 100%;
    --secondary: 220 13% 90%;
    --secondary-foreground: 220 13% 13%;
    --muted: 220 13% 90%;
    --muted-foreground: 220 13% 45%;
    --accent: 174 100% 29%;
    --accent-foreground: 0 0% 100%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 220 13% 89%;
    --input: 220 13% 89%;
    --ring: 231 48% 48%;
    --radius: 0.5rem;
    --chart-1: 231 48% 48%;
    --chart-2: 174 100% 29%;
    --chart-3: 43 74% 66%;
    --chart-4: 27 87% 67%;
    --chart-5: 12 76% 61%;
    --sidebar-background: 0 0% 100%;
    --sidebar-foreground: 240 5.3% 26.1%;
    --sidebar-primary: 231 48% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 220 13% 96%;
    --sidebar-accent-foreground: 231 48% 48%;
    --sidebar-border: 220 13% 89%;
    --sidebar-ring: 231 48% 48%;

    /* UI Decor (layered themes) */
    --ui-decor-accent: 43 90% 62%;
    --ui-decor-opacity: 0.35;
  }
  .dark {
    --background: 222 47% 11%;
    --foreground: 210 40% 98%;
    --card: 222 47% 11%;
    --card-foreground: 210 40% 98%;
    --popover: 222 47% 11%;
    --popover-foreground: 210 40% 98%;
    --primary: 231 48% 48%;
    --primary-foreground: 0 0% 100%;
    --secondary: 217 33% 17%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217 33% 17%;
    --muted-foreground: 215 20% 65%;
    --accent: 174 100% 34%;
    --accent-foreground: 0 0% 100%;
    --destructive: 0 63% 31%;
    --destructive-foreground: 210 40% 98%;
    --border: 217 33% 17%;
    --input: 217 33% 17%;
    --ring: 231 48% 48%;
    --chart-1: 231 48% 48%;
    --chart-2: 174 100% 34%;
    --chart-3: 43 74% 66%;
    --chart-4: 27 87% 67%;
    --chart-5: 12 76% 61%;
    --sidebar-background: 222 47% 11%;
    --sidebar-foreground: 210 40% 98%;
    --sidebar-primary: 231 48% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 217 33% 17%;
    --sidebar-accent-foreground: 210 40% 98%;
    --sidebar-border: 217 33% 17%;
    --sidebar-ring: 231 48% 48%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  html {
    @apply overflow-x-hidden;
  }
  body {
    @apply bg-background text-foreground overflow-x-hidden;
  }
}

@layer utilities {
  /* ---------------------------------------- */
  /* UI Decor: ONLY on explicit action buttons */
  /* ---------------------------------------- */
  html[data-ui-decor="on"] .ui-action-btn {
    position: relative;
    overflow: hidden;
    isolation: isolate;
  }

  /* Map the button's background to a var (complement computed via hue-rotate). */
  html[data-ui-decor="on"] .ui-action-btn.bg-primary {
    --ui-action-bg: hsl(var(--primary));
  }
  html[data-ui-decor="on"] .ui-action-btn.bg-destructive {
    --ui-action-bg: hsl(var(--destructive));
  }
  html[data-ui-decor="on"] .ui-action-btn.bg-secondary {
    --ui-action-bg: hsl(var(--secondary));
  }

  html[data-ui-decor="on"]:not([data-ui-decor-style="flowerRing"]) .ui-action-btn::after {
    content: "";
    position: absolute;
    right: 10px;
    top: 50%;
    width: 22px;
    height: 22px;
    transform: translateY(-50%) rotate(-8deg);
    pointer-events: none;
    opacity: calc(0.20 + (var(--ui-decor-opacity) * 0.35));

    /* Retro-ish flower stamp using hard radial gradients + outline */
    background:
      radial-gradient(circle at 50% 50%, rgba(0, 0, 0, 0.15) 0 10%, transparent 11%),
      radial-gradient(circle at 50% 35%, var(--ui-action-bg, hsl(var(--ui-decor-accent))) 0 26%, transparent 27%),
      radial-gradient(circle at 65% 50%, var(--ui-action-bg, hsl(var(--ui-decor-accent))) 0 26%, transparent 27%),
      radial-gradient(circle at 50% 65%, var(--ui-action-bg, hsl(var(--ui-decor-accent))) 0 26%, transparent 27%),
      radial-gradient(circle at 35% 50%, var(--ui-action-bg, hsl(var(--ui-decor-accent))) 0 26%, transparent 27%),
      radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.75) 0 20%, transparent 21%);

    /* Complementary color relative to the button bg */
    filter: hue-rotate(180deg) saturate(1.25) contrast(1.08);
    box-shadow:
      0 0 0 1px rgba(0, 0, 0, 0.18),
      2px 2px 0 rgba(0, 0, 0, 0.12);
  }

  html.dark[data-ui-decor="on"]:not([data-ui-decor-style="flowerRing"]) .ui-action-btn::after {
    box-shadow:
      0 0 0 1px rgba(255, 255, 255, 0.12),
      2px 2px 0 rgba(0, 0, 0, 0.22);
  }

  /* ---------------------------------------- */
  /* Decor style: flowerRing (snippet-based)   */
  /* ---------------------------------------- */
  html[data-ui-decor="on"][data-ui-decor-style="flowerRing"] .ui-action-btn {
    overflow: visible;
  }

  /* CSS-only flowers: avoids extra DOM so Button asChild won't break. */
  html[data-ui-decor="on"][data-ui-decor-style="flowerRing"] .ui-action-btn::before,
  html[data-ui-decor="on"][data-ui-decor-style="flowerRing"] .ui-action-btn::after {
    content: "";
    position: absolute;
    inset: -28px;
    pointer-events: none;
    opacity: calc(0.25 + (var(--ui-decor-opacity) * 0.35));
    filter: hue-rotate(180deg) saturate(1.1) contrast(1.05);
    -webkit-mask-repeat: no-repeat;
    mask-repeat: no-repeat;
  }

  /* Petals mask */
  html[data-ui-decor="on"][data-ui-decor-style="flowerRing"] .ui-action-btn::before {
    background-color: hsl(var(--ui-decor-accent));
    -webkit-mask-image:
      radial-gradient(circle 6px at 18px 6px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 30px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 30px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 6px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 6px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 30px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 30px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 6px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 6px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 30px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 30px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 6px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 6px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 30px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 30px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 6px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 10px, #000 99%, transparent 100%);
    mask-image:
      radial-gradient(circle 6px at 18px 6px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 30px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 30px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 6px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 6px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 30px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 30px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 6px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 6px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 30px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 30px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 6px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 6px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 10px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 30px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 26px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 18px 30px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 26px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 6px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 6px at 10px 10px, #000 99%, transparent 100%);
    -webkit-mask-size:
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px;
    mask-size:
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px,
      36px 36px, 36px 36px, 36px 36px, 36px 36px;

    /* 8 flowers around the button (each flower is 8 petals -> 64 masks) */
    -webkit-mask-position:
      50% -25px, 50% -25px, 50% -25px, 50% -25px, 50% -25px, 50% -25px, 50% -25px, 50% -25px,
      75% -18px, 75% -18px, 75% -18px, 75% -18px, 75% -18px, 75% -18px, 75% -18px, 75% -18px,
      calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%,
      75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px),
      50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px),
      25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px),
      -20px 50%, -20px 50%, -20px 50%, -20px 50%, -20px 50%, -20px 50%, -20px 50%, -20px 50%,
      25% -18px, 25% -18px, 25% -18px, 25% -18px, 25% -18px, 25% -18px, 25% -18px, 25% -18px;
    mask-position:
      50% -25px, 50% -25px, 50% -25px, 50% -25px, 50% -25px, 50% -25px, 50% -25px, 50% -25px,
      75% -18px, 75% -18px, 75% -18px, 75% -18px, 75% -18px, 75% -18px, 75% -18px, 75% -18px,
      calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%, calc(100% + 20px) 50%,
      75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px), 75% calc(100% + 18px),
      50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px), 50% calc(100% + 25px),
      25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px), 25% calc(100% + 18px),
      -20px 50%, -20px 50%, -20px 50%, -20px 50%, -20px 50%, -20px 50%, -20px 50%, -20px 50%,
      25% -18px, 25% -18px, 25% -18px, 25% -18px, 25% -18px, 25% -18px, 25% -18px, 25% -18px;
  }

  /* Centers (orange) */
  html[data-ui-decor="on"][data-ui-decor-style="flowerRing"] .ui-action-btn::after {
    background-color: hsl(25 95% 53% / 0.9);
    -webkit-mask-image:
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%);
    mask-image:
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%),
      radial-gradient(circle 7px at 18px 18px, #000 99%, transparent 100%);
    -webkit-mask-size: 36px 36px;
    mask-size: 36px 36px;
    -webkit-mask-position:
      50% -25px,
      75% -18px,
      calc(100% + 20px) 50%,
      75% calc(100% + 18px),
      50% calc(100% + 25px),
      25% calc(100% + 18px),
      -20px 50%,
      25% -18px;
    mask-position:
      50% -25px,
      75% -18px,
      calc(100% + 20px) 50%,
      75% calc(100% + 18px),
      50% calc(100% + 25px),
      25% calc(100% + 18px),
      -20px 50%,
      25% -18px;
  }

  html[data-ui-animejs="on"][data-ui-animation-preset="show"] .ui-show-glow {
    filter: drop-shadow(0 0 14px hsl(var(--primary) / 0.55));
  }

  html[data-ui-animejs="on"][data-ui-animation-preset="show"] body::before {
    content: "";
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 0;
    background:
      radial-gradient(1200px circle at 20% 0%, hsl(var(--primary) / 0.12), transparent 55%),
      radial-gradient(900px circle at 80% 20%, hsl(var(--accent) / 0.10), transparent 60%),
      repeating-linear-gradient(
        to bottom,
        rgba(255, 255, 255, 0.05) 0px,
        rgba(255, 255, 255, 0.05) 1px,
        rgba(0, 0, 0, 0) 3px,
        rgba(0, 0, 0, 0) 6px
      );
    opacity: 0.35;
    mix-blend-mode: overlay;
  }

  html[data-ui-animejs="on"][data-ui-animation-preset="show"] body {
    position: relative;
  }

  html[data-ui-animejs="on"][data-ui-animation-preset="show"] #__next,
  html[data-ui-animejs="on"][data-ui-animation-preset="show"] main,
  html[data-ui-animejs="on"][data-ui-animation-preset="show"] header {
    position: relative;
    z-index: 1;
  }
}
